<!DOCTYPE html>
<html>

  <head>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-6195355-4', 'yubico.com');
  ga('send', 'pageview');

</script>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="yubico-piv-tool : Command line tool for the YubiKey NEO PIV applet" />

    <link rel="stylesheet" type="text/css" media="screen" href="/stylesheets/stylesheet.css">

    <title>yubico-piv-tool</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
        <span class="breadcrumb">
          <a href="/">Software listing</a>
          /
          <a href="/yubico-piv-tool/">yubico-piv-tool</a>
          /
          <a>Windows-Certificate</a>
          </span>
          <a id="forkme_banner" href="https://github.com/Yubico/yubico-piv-tool">View on GitHub</a>
<a id="travis_link" href="https://travis-ci.org/Yubico/yubico-piv-tool"><img id="travis_img" src="https://travis-ci.org/Yubico/yubico-piv-tool.svg?branch=master"/></a>
          <h1><a id="project_title" href="/yubico-piv-tool/">yubico-piv-tool</a></h1>
          <h2 id="project_tagline">Command line tool for the YubiKey NEO PIV applet</h2>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
<div class="sect1">
<h2 id="_request_and_load_a_certificate_from_windows_ca">Request and load a certificate from Windows CA</h2>
<div class="sectionbody">
<div class="paragraph"><p>This is a short step-by-step on how to generate a key in the Neo,
create a certificate request, submit that request to a Windows CA
and then load the certificate in the Neo.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites">Prerequisites</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
a YubiKey Neo with the PIV applet loaded
</p>
</li>
<li>
<p>
the yubico-piv-tool software
</p>
</li>
<li>
<p>
credentials to request certs from a Windows CA
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_steps">Steps</h2>
<div class="sectionbody">
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Generate the key:
</p>
<div class="literalblock">
<div class="content">
<pre><tt>yubico-piv-tool -s 9a -a generate -o public.pem</tt></pre>
</div></div>
</li>
<li>
<p>
Request a certificate:
</p>
<div class="literalblock">
<div class="content">
<pre><tt>yubico-piv-tool -a verify-pin -P 123456 -s 9a -a request-certificate \
      -S "/CN=example/O=test/" -i public.pem -o request.csr</tt></pre>
</div></div>
</li>
<li>
<p>
Submit the request to the Windows CA:
   (this step must be run on a windows machine that know about the CA)
</p>
<div class="literalblock">
<div class="content">
<pre><tt>certreq -submit -attrib "CertificateTemplate:User" request.csr cert.crt</tt></pre>
</div></div>
</li>
<li>
<p>
Load the certificate in the Neo:
</p>
<div class="literalblock">
<div class="content">
<pre><tt>yubico-piv-tool -s 9a -a import-certificate -i cert.crt</tt></pre>
</div></div>
</li>
<li>
<p>
For it to be useful in windows a chuid must be set as well:
   (only if that wasn&#8217;t done earlier)
</p>
<div class="literalblock">
<div class="content">
<pre><tt>yubico-piv-tool -a set-chuid</tt></pre>
</div></div>
</li>
</ol></div>
</div>
</div>

</section>
</div>

<!-- FOOTER  -->
<div id="footer_wrap" class="outer">
<footer class="inner">
<p class="copyright">yubico-piv-tool maintained by <a href="https://github.com/Yubico">Yubico</a></p>
<p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
</footer>
</div></body></html>
