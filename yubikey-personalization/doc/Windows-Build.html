
<!DOCTYPE html>
<html>

  <head>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-6195355-4', 'yubico.com');
  ga('send', 'pageview');

</script>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="yubikey-personalization : YubiKey Personalization cross-platform library and tool" />

    <link rel="stylesheet" type="text/css" media="screen" href="/stylesheets/stylesheet.css">

    <title>yubikey-personalization</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/Yubico/yubikey-personalization">View on GitHub</a>
<a id="travis_link" href="https://travis-ci.org/Yubico/yubikey-personalization"><img id="travis_img" src="https://travis-ci.org/Yubico/yubikey-personalization.png?branch=master"/></a>
          <h1 id="project_title">yubikey-personalization</h1>
          <h2 id="project_tagline">YubiKey Personalization cross-platform library and tool</h2>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
<div class="sect1">
<h2 id="_build_yubikey_personalization_for_windows">Build yubikey-personalization for Windows</h2>
<div class="sectionbody">
<div class="paragraph"><p>The yubikey-personalization library and tools works fine on multiple
platforms: GNU/Linux, Mac OS X and Windows.  Building for Windows is
relatively easy if you follow these steps.</p></div>
<div class="paragraph"><p>First install a Windows cross-compiler on your GNU/Linux system.  We
recommend the MinGW-w64 project because it is easy to install and
provides cross-compilers for both 32-bit and 64-bit Windows.  For more
information about the MinGW-w64 project please see:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>http://mingw-w64.sourceforge.net/</tt></pre>
</div></div>
<div class="paragraph"><p>To build the compiler follow these steps:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>$ mkdir mingw-w64-32
$ cd mingw-w64-32
$ wget -q http://mingw-w64.svn.sourceforge.net/viewvc/mingw-w64/experimental/buildsystem/makebuildroot-test.mk
$ $EDITOR makebuildroot-test.mk</tt></pre>
</div></div>
<div class="paragraph"><p>In the editor, modify TARGET_ARCH to be <em>i686-w64-mingw32</em>, set
GCC_FORTRAN and GCC_OBJC to <em>N</em> (unless you have some other use for
Fortran/ObjectiveC cross-compilers), and set GCC_BRANCH to
<em>tags/gcc_4_5_1_release</em> which is a known stable GCC release.  Then
build your cross-compiler:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>$ make -f makebuildroot-test.mk
...</tt></pre>
</div></div>
<div class="paragraph"><p>This will take some time, but when it is finished, place
mingw-w64-32/build/root/bin/ in your PATH or symlink the files into
/usr/local/bin or similar.</p></div>
<div class="paragraph"><p>To build the 64-bit compiler (optional), redo the above command but
replace mingw-w64-32 with mingw-w64-64 and <em>i686-w64-mingw32</em> with
<em>x86_64-w64-mingw32</em>.</p></div>
<div class="paragraph"><p>You also need to install Wine to have <em>make check</em> work.  It needs to
be relatively modern in order to work properly.  On a dpkg-based
system, here is how to install it:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>$ apt-get install wine</tt></pre>
</div></div>
<div class="paragraph"><p>Let&#8217;s create a directory where all our further work will be done.  I&#8217;m
assuming it is $HOME/ykpers4win.  If you use another path, you need to
replace the occurances of that path with your own path below.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>$ mkdir $HOME/ykpers4win
$ cd $HOME/ykpers4win</tt></pre>
</div></div>
<div class="paragraph"><p>The next step is to build and install libyubikey.  Follow these steps:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>$ wget -q http://yubico-c.googlecode.com/files/libyubikey-1.7.tar.gz
$ tar xfa libyubikey-1.7.tar.gz
$ cd libyubikey-1.7
$ ./configure --host=i686-w64-mingw32 --build=x86_64-unknown-linux-gnu --prefix=$HOME/ykpers4win/root
$ make install check
$ cd ..</tt></pre>
</div></div>
<div class="paragraph"><p>Now it is time to install the yubikey-personalization library and tool
itself.  Follow these steps:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>$ wget -q http://yubikey-personalization.googlecode.com/files/ykpers-1.5.1.tar.gz
$ tar xfa ykpers-1.5.1.tar.gz
$ cd ykpers-1.5.1/
$ lt_cv_deplibs_check_method=pass_all ./configure --host=i686-w64-mingw32 --build=x86_64-unknown-linux-gnu --prefix=$HOME/ykpers4win/root LDFLAGS=-L$HOME/ykpers4win/root/lib CPPFLAGS=-I$HOME/ykpers4win/root/include
$ make install check
$ cd ..</tt></pre>
</div></div>
<div class="paragraph"><p>That&#8217;s it!  You should now have all the necessary files in
$HOME/ykpers4win/root/.</p></div>
<div class="paragraph"><p>Test the build by transferring the directory (only the files in bin/
are necessary) to a Windows machine and start CMD.EXE, change into the
bin/ directory and then invoke:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>D:\root\bin&gt;ykpersonalize -ofixed=ccccccbbbbbb
...</tt></pre>
</div></div>
<div class="paragraph"><p>It should query for a passphrase to generate the AES key, and then ask
whether you want to reprogram your YubiKey.  It should finish without
any error message.  Touch the YubiKey button and it should emit OTPs
correctly.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_on_libusb_under_windows">On libusb under Windows</h2>
<div class="sectionbody">
<div class="paragraph"><p>Traditionally, we were using Libusb (both 0.x and 1.0 should work)
under Windows.  Libusb 0.x is considered obsolete and libusb 1.x (up
to and including at least 1.0.8) had some bugs under Windows which
made it unusable for us.  Therefor, recent versions of
yubikey-personalization do not require libusb, but instead uses native
Windows code.</p></div>
<div class="paragraph"><p>If you are interested in building with libusb 1.x instead of the
native Windows code, you may use instructions below to build libusb
1.x.  Don&#8217;t forget to configure yubikey-personalization using
--with-backend=libusb or --with-backend=libusb-1.0.  You would build
libusb after libyubikey but before yubikey-personalization.  We
provide a somewhat modified libusb-1.0 tar archive that solves some
build issues.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>$ wget -q http://yubikey-personalization.googlecode.com/files/libusb-1.0.8-windows.tar.bz2
$ tar xfa libusb-1.0.8-windows.tar.bz2
$ cd libusb-1.0.8
$ ./configure --host=i686-w64-mingw32 --build=x86_64-unknown-linux-gnu --prefix=$HOME/ykpers4win/root
$ make install
$ cd ..</tt></pre>
</div></div>
</div>
</div>

</section>
</div>

<!-- FOOTER  -->
<div id="footer_wrap" class="outer">
<footer class="inner">
<p class="copyright">yubikey-personalization maintained by <a href="https://github.com/Yubico">Yubico</a></p>
<p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
</footer>
</div></body></html>
