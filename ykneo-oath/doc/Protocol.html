<!DOCTYPE html>
<html>

  <head>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-6195355-4', 'yubico.com');
  ga('send', 'pageview');

</script>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="ykneo-oath : OATH App for the YubiKey NEO" />

    <link rel="stylesheet" type="text/css" media="screen" href="/stylesheets/stylesheet.css">

    <title>ykneo-oath</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
        <span class="breadcrumb">
          <a href="/">Software listing</a>
          /
          <a href="/ykneo-oath/">ykneo-oath</a>
          /
          <a>Protocol</a>
          </span>
          <a id="forkme_banner" href="https://github.com/Yubico/ykneo-oath">View on GitHub</a>

          <h1><a id="project_title" href="/ykneo-oath/">ykneo-oath</a></h1>
          <h2 id="project_tagline">OATH App for the YubiKey NEO</h2>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
<div class="sect1">
<h2 id="_general_definitions">General Definitions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_instructions">Instructions</h3>
<div class="paragraph"><p>Instructions marked as <em>Require Auth</em> require a successful VALIDATE to be
performed before they&#8217;re available if a code is set.</p></div>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Name</p></td>
<td align="left" valign="top"><p class="table">Code</p></td>
<td align="left" valign="top"><p class="table">Require Auth</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">PUT</p></td>
<td align="left" valign="top"><p class="table">0x01</p></td>
<td align="left" valign="top"><p class="table">Y</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">DELETE</p></td>
<td align="left" valign="top"><p class="table">0x02</p></td>
<td align="left" valign="top"><p class="table">Y</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">SET CODE</p></td>
<td align="left" valign="top"><p class="table">0x03</p></td>
<td align="left" valign="top"><p class="table">Y</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">RESET</p></td>
<td align="left" valign="top"><p class="table">0x04</p></td>
<td align="left" valign="top"><p class="table">N</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">LIST</p></td>
<td align="left" valign="top"><p class="table">0xa1</p></td>
<td align="left" valign="top"><p class="table">Y</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">CALCULATE</p></td>
<td align="left" valign="top"><p class="table">0xa2</p></td>
<td align="left" valign="top"><p class="table">Y</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">VALIDATE</p></td>
<td align="left" valign="top"><p class="table">0xa3</p></td>
<td align="left" valign="top"><p class="table">N</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">CALCULATE ALL</p></td>
<td align="left" valign="top"><p class="table">0xa4</p></td>
<td align="left" valign="top"><p class="table">Y</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">SEND REMAINING</p></td>
<td align="left" valign="top"><p class="table">0xa5</p></td>
<td align="left" valign="top"><p class="table">Y</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_algorithms">ALGORITHMS</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">HMAC-SHA1</p></td>
<td align="left" valign="top"><p class="table">0x01</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">HMAC-SHA256</p></td>
<td align="left" valign="top"><p class="table">0x02</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_types">TYPES</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">HOTP</p></td>
<td align="left" valign="top"><p class="table">0x20</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">TOTP</p></td>
<td align="left" valign="top"><p class="table">0x20</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_properties">PROPERTIES</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Only increasing</p></td>
<td align="left" valign="top"><p class="table">0x01</p></td>
<td align="left" valign="top"><p class="table">Enforces that a challenge is always higher than the previous</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_select_instruction">SELECT INSTRUCTION</h2>
<div class="sectionbody">
<div class="paragraph"><p>Selects the applet for usage and returns, version, ID and a challenge if
authentication is configured.</p></div>
<div class="sect2">
<h3 id="_request_syntax">Request Syntax</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">CLA</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">INS</p></td>
<td align="left" valign="top"><p class="table">0xa4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P1</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P2</p></td>
<td align="left" valign="top"><p class="table">0x04</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Lc</p></td>
<td align="left" valign="top"><p class="table">Length of AID</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Data</p></td>
<td align="left" valign="top"><p class="table">AID</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_response_syntax">Response Syntax</h3>
<div class="paragraph"><p>Challenge is returned if the authentication object is set. In that case
authentication is required for all commands except validate and reset.</p></div>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Version tag</p></td>
<td align="left" valign="top"><p class="table">0x79</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Version length</p></td>
<td align="left" valign="top"><p class="table">Len of version</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Version data</p></td>
<td align="left" valign="top"><p class="table">Version</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Name tag</p></td>
<td align="left" valign="top"><p class="table">0x71</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Name length</p></td>
<td align="left" valign="top"><p class="table">Len of name</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Name data</p></td>
<td align="left" valign="top"><p class="table">Name</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Challenge tag</p></td>
<td align="left" valign="top"><p class="table">0x74</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Challenge length</p></td>
<td align="left" valign="top"><p class="table">Len of challenge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Challenge data</p></td>
<td align="left" valign="top"><p class="table">Challenge</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_put_instruction">PUT INSTRUCTION</h2>
<div class="sectionbody">
<div class="paragraph"><p>Adds a new (or overwrites) OATH code.</p></div>
<div class="sect2">
<h3 id="_request_syntax_2">Request Syntax</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">CLA</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">INS</p></td>
<td align="left" valign="top"><p class="table">0x01</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P1</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P2</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Lc</p></td>
<td align="left" valign="top"><p class="table">Length of Data</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Data</p></td>
<td align="left" valign="top"><p class="table">Put Data</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_put_data">Put Data</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Name tag</p></td>
<td align="left" valign="top"><p class="table">0x71</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Name length</p></td>
<td align="left" valign="top"><p class="table">Len of name data</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Name data</p></td>
<td align="left" valign="top"><p class="table">Name</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Key tag</p></td>
<td align="left" valign="top"><p class="table">0x73</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Key length</p></td>
<td align="left" valign="top"><p class="table">Len of key data + 2</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Key algorithm</p></td>
<td align="left" valign="top"><p class="table">High 4 bits is type, low 4 bits is algorithm</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Digits</p></td>
<td align="left" valign="top"><p class="table">Number of digits in code</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Key data</p></td>
<td align="left" valign="top"><p class="table">Key</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Property(o)</p></td>
<td align="left" valign="top"><p class="table">Property byte</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">IMF tag(o)</p></td>
<td align="left" valign="top"><p class="table">0x7a (only valid for HOTP)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">IMF length(o)</p></td>
<td align="left" valign="top"><p class="table">Len of imf data</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">IMF data(o)</p></td>
<td align="left" valign="top"><p class="table">Imf</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_response_codes">Response Codes</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Success</p></td>
<td align="left" valign="top"><p class="table">0x9000</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">No space</p></td>
<td align="left" valign="top"><p class="table">0x6a84</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Auth required</p></td>
<td align="left" valign="top"><p class="table">0x6982</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Wrong syntax</p></td>
<td align="left" valign="top"><p class="table">0x6a80</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_delete_instruction">DELETE INSTRUCTION</h2>
<div class="sectionbody">
<div class="paragraph"><p>Deletes an existing code.</p></div>
<div class="sect2">
<h3 id="_request_syntax_3">Request Syntax</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">CLA</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">INS</p></td>
<td align="left" valign="top"><p class="table">0x02</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P1</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P2</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Lc</p></td>
<td align="left" valign="top"><p class="table">Length of Data</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Data</p></td>
<td align="left" valign="top"><p class="table">Delete Data</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_delete_data">Delete Data</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Name tag</p></td>
<td align="left" valign="top"><p class="table">0x71</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Name length</p></td>
<td align="left" valign="top"><p class="table">Len of name data</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Name data</p></td>
<td align="left" valign="top"><p class="table">Name</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_response_codes_2">Response Codes</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Success</p></td>
<td align="left" valign="top"><p class="table">0x9000</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">No such object</p></td>
<td align="left" valign="top"><p class="table">0x6984</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Auth required</p></td>
<td align="left" valign="top"><p class="table">0x6982</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Wrong syntax</p></td>
<td align="left" valign="top"><p class="table">0x6a80</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_set_code_instruction">SET CODE INSTRUCTION</h2>
<div class="sectionbody">
<div class="paragraph"><p>Configures Authentication.
If length 0 is sent authentication is removed.
The key to be set is expected to be a user-supplied password passed through
1000 rounds of pbkdf2 with the ID from select as salt. 16 bytes of that is used.
When configuring authentication you&#8217;re required to send a challenge and one
authentication-response with that key as well to confirm that the applet and
host software calculates the same response for that key.</p></div>
<div class="sect2">
<h3 id="_request_syntax_4">Request Syntax</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">CLA</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">INS</p></td>
<td align="left" valign="top"><p class="table">0x03</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P1</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P2</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Lc</p></td>
<td align="left" valign="top"><p class="table">Length of Data</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Data</p></td>
<td align="left" valign="top"><p class="table">Set Code Data</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_set_code_data">Set Code Data</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Key tag</p></td>
<td align="left" valign="top"><p class="table">0x73</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Key length</p></td>
<td align="left" valign="top"><p class="table">Len of key data + 1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Key algorithm</p></td>
<td align="left" valign="top"><p class="table">Algorithm</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Key data</p></td>
<td align="left" valign="top"><p class="table">Key</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Challenge tag</p></td>
<td align="left" valign="top"><p class="table">0x74</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Challenge length</p></td>
<td align="left" valign="top"><p class="table">Len of challenge data</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Challenge data</p></td>
<td align="left" valign="top"><p class="table">Challenge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Response tag</p></td>
<td align="left" valign="top"><p class="table">0x75</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Response length</p></td>
<td align="left" valign="top"><p class="table">Len of response data</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Response data</p></td>
<td align="left" valign="top"><p class="table">Response</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_response_codes_3">Response Codes</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Success</p></td>
<td align="left" valign="top"><p class="table">0x9000</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Response doesn&#8217;t match</p></td>
<td align="left" valign="top"><p class="table">0x6984</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Auth required</p></td>
<td align="left" valign="top"><p class="table">0x6982</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Wrong syntax</p></td>
<td align="left" valign="top"><p class="table">0x6a80</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reset_instruction">RESET INSTRUCTION</h2>
<div class="sectionbody">
<div class="paragraph"><p>Reset the applet to just-installed state.</p></div>
<div class="sect2">
<h3 id="_request_syntax_5">Request Syntax</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">CLA</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">INS</p></td>
<td align="left" valign="top"><p class="table">0x04</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P1</p></td>
<td align="left" valign="top"><p class="table">0xde</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P2</p></td>
<td align="left" valign="top"><p class="table">0xad</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_response_codes_4">Response Codes</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Success</p></td>
<td align="left" valign="top"><p class="table">0x9000</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_list_instruction">LIST INSTRUCTION</h2>
<div class="sectionbody">
<div class="paragraph"><p>List configured codes.</p></div>
<div class="sect2">
<h3 id="_request_syntax_6">Request Syntax</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">CLA</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">INS</p></td>
<td align="left" valign="top"><p class="table">0xa1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P1</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P2</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_response_syntax_2">Response Syntax</h3>
<div class="paragraph"><p>Response will be a cotinual list of objects looking like:</p></div>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Name list tag</p></td>
<td align="left" valign="top"><p class="table">0x72</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Name length</p></td>
<td align="left" valign="top"><p class="table">Len of name + 1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Name data</p></td>
<td align="left" valign="top"><p class="table">Name</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Algorithm</p></td>
<td align="left" valign="top"><p class="table">High 4 bits is type, low 4 bits is algorithm</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_calculate_instruction">CALCULATE INSTRUCTION</h2>
<div class="sectionbody">
<div class="paragraph"><p>Do calculate for one named code.</p></div>
<div class="sect2">
<h3 id="_request_syntax_7">Request Syntax</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">CLA</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">INS</p></td>
<td align="left" valign="top"><p class="table">0xa1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P1</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P2</p></td>
<td align="left" valign="top"><p class="table">0x00 for full response 0x01 for truncated</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Lc</p></td>
<td align="left" valign="top"><p class="table">Length of data</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Data</p></td>
<td align="left" valign="top"><p class="table">Calculate data</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_calculate_data">Calculate Data</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Name tag</p></td>
<td align="left" valign="top"><p class="table">0x71</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Name length</p></td>
<td align="left" valign="top"><p class="table">Len of name data</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Name data</p></td>
<td align="left" valign="top"><p class="table">Name</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Challenge tag</p></td>
<td align="left" valign="top"><p class="table">0x74</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Challenge length</p></td>
<td align="left" valign="top"><p class="table">Len of challenge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Challenge data</p></td>
<td align="left" valign="top"><p class="table">Challenge</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_response_syntax_3">Response Syntax</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Response tag</p></td>
<td align="left" valign="top"><p class="table">0x75 for full response, 0x76 for truncated</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Response length</p></td>
<td align="left" valign="top"><p class="table">Len of response + 1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Digits</p></td>
<td align="left" valign="top"><p class="table">Number of digits in the code</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Response data</p></td>
<td align="left" valign="top"><p class="table">Response</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_response_codes_5">Response Codes</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Success</p></td>
<td align="left" valign="top"><p class="table">0x9000</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">No such object</p></td>
<td align="left" valign="top"><p class="table">0x6984</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Auth required</p></td>
<td align="left" valign="top"><p class="table">0x6982</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Wrong syntax</p></td>
<td align="left" valign="top"><p class="table">0x6a80</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_validate_instruction">VALIDATE INSTRUCTION</h2>
<div class="sectionbody">
<div class="paragraph"><p>Validate authentication (mutually).
The challenge for this comes from the select command, perform the correct hmac
function over that challenge with the correct key. Then send a new challenge to
the applet together with the response, the applet will then respond with a
calculation of that that the host software can verify.</p></div>
<div class="sect2">
<h3 id="_request_syntax_8">Request Syntax</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">CLA</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">INS</p></td>
<td align="left" valign="top"><p class="table">0xa2</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P1</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P2</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Lc</p></td>
<td align="left" valign="top"><p class="table">Length of data</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Data</p></td>
<td align="left" valign="top"><p class="table">Validate data</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_validate_data">Validate Data</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Response tag</p></td>
<td align="left" valign="top"><p class="table">0x75</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Response length</p></td>
<td align="left" valign="top"><p class="table">Len of response</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Response data</p></td>
<td align="left" valign="top"><p class="table">Response</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Challenge tag</p></td>
<td align="left" valign="top"><p class="table">0x74</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Challenge length</p></td>
<td align="left" valign="top"><p class="table">Len of challenge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Challenge data</p></td>
<td align="left" valign="top"><p class="table">Challenge</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_response_syntax_4">Response Syntax</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Response tag</p></td>
<td align="left" valign="top"><p class="table">0x75</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Response length</p></td>
<td align="left" valign="top"><p class="table">Len of response</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Response data</p></td>
<td align="left" valign="top"><p class="table">Response</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_response_codes_6">Response Codes</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Success</p></td>
<td align="left" valign="top"><p class="table">0x9000</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Auth not enabled</p></td>
<td align="left" valign="top"><p class="table">0x6984</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Wrong syntax</p></td>
<td align="left" valign="top"><p class="table">0x6a80</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_calculate_all_instruction">CALCULATE ALL INSTRUCTION</h2>
<div class="sectionbody">
<div class="paragraph"><p>Do calculation for all available codes, returns name + response for TOTP and
just name for HOTP.</p></div>
<div class="sect2">
<h3 id="_request_syntax_9">Request Syntax</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">CLA</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">INS</p></td>
<td align="left" valign="top"><p class="table">0xa4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P1</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P2</p></td>
<td align="left" valign="top"><p class="table">0x00 for full response 0x01 for truncated</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Lc</p></td>
<td align="left" valign="top"><p class="table">Length of data</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Data</p></td>
<td align="left" valign="top"><p class="table">Calculate all data</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_calculate_all_data">Calculate All Data</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Challenge tag</p></td>
<td align="left" valign="top"><p class="table">0x74</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Challenge length</p></td>
<td align="left" valign="top"><p class="table">Len of challenge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Challenge data</p></td>
<td align="left" valign="top"><p class="table">Challenge</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_response_syntax_5">Response Syntax</h3>
<div class="paragraph"><p>For HOTP the response tag is 0x77 (No response)
The response will be a list of the following objects:</p></div>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Name tag</p></td>
<td align="left" valign="top"><p class="table">0x71</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Name length</p></td>
<td align="left" valign="top"><p class="table">Length of name</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Name data</p></td>
<td align="left" valign="top"><p class="table">Name</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Response tag</p></td>
<td align="left" valign="top"><p class="table">0x77 for HOTP, 0x75 for full response or 0x76 for truncated response</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Response len</p></td>
<td align="left" valign="top"><p class="table">Lenth of response + 1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Digits</p></td>
<td align="left" valign="top"><p class="table">Number of digits in the code</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Response data</p></td>
<td align="left" valign="top"><p class="table">Response</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_response_codes_7">Response Codes</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Success</p></td>
<td align="left" valign="top"><p class="table">0x9000</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">More data available</p></td>
<td align="left" valign="top"><p class="table">0x61xx</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Auth required</p></td>
<td align="left" valign="top"><p class="table">0x6982</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Wrong syntax</p></td>
<td align="left" valign="top"><p class="table">0x6a80</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_send_remaining_instruction">SEND REMAINING INSTRUCTION</h2>
<div class="sectionbody">
<div class="paragraph"><p>Send remaining data if everything didn&#8217;t fit in previous response (response
code was 61xx).</p></div>
<div class="sect2">
<h3 id="_request_syntax_10">Request Syntax</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">CLA</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">INS</p></td>
<td align="left" valign="top"><p class="table">0xa5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P1</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">P2</p></td>
<td align="left" valign="top"><p class="table">0x00</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_response_syntax_6">Response Syntax</h3>
<div class="tableblock">
<table rules="all"
frame="border"
cellspacing="0" cellpadding="4">
<col />
<col />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Data</p></td>
<td align="left" valign="top"><p class="table">Continued data where previouse command left off</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>

</section>
</div>

<!-- FOOTER  -->
<div id="footer_wrap" class="outer">
<footer class="inner">
<p class="copyright">ykneo-oath maintained by <a href="https://github.com/Yubico">Yubico</a></p>
<p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
</footer>
</div></body></html>
