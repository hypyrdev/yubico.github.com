<!DOCTYPE html>
<html>

  <head>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-6195355-4', 'yubico.com');
  ga('send', 'pageview');

</script>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="ykneo-openpgp : OpenPGP app for the YubiKey NEO" />

    <link rel="stylesheet" type="text/css" media="screen" href="/stylesheets/stylesheet.css">

    <title>ykneo-openpgp</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
        <span class="breadcrumb">
          <a href="/">Software listing</a>
          /
          <a href="/ykneo-openpgp/">ykneo-openpgp</a>
          /
          <a>ResetApplet</a>
          </span>
          <a id="forkme_banner" href="https://github.com/Yubico/ykneo-openpgp">View on GitHub</a>
<a id="travis_link" href="https://travis-ci.org/Yubico/ykneo-openpgp"><img id="travis_img" src="https://travis-ci.org/Yubico/ykneo-openpgp.svg?branch=master"/></a>
          <h1><a id="project_title" href="/ykneo-openpgp/">ykneo-openpgp</a></h1>
          <h2 id="project_tagline">OpenPGP app for the YubiKey NEO</h2>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph"><p>This is a set of instructions that will allow you to reset your
ykneo-openpgp applet.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites">Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph"><p>For this procedure, you must have GnuPG version 2.0.22 or later and
ykneo-openpgp applet version 1.0.6 or later installed.  To check the
applet version run the following.</p></div>
<div class="literalblock">
<div class="content">
<pre><tt> $ gpg2 --version
 ...
 $ gpg-connect-agent --hex "scd apdu 00 f1 00 00" /bye
 D[0000]  01 00 06 90 00                                     .....
 OK</tt></pre>
</div></div>
<div class="paragraph"><p>The string "01 00 06" means version 1.0.6.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_reset_the_applet">Reset the applet</h2>
<div class="sectionbody">
<div class="paragraph"><p>The reset procedure consists of two parts.</p></div>
<div class="paragraph"><p>First, the card is locked by entering the wrong PIN and Admin PIN
multiple times.</p></div>
<div class="literalblock">
<div class="content">
<pre><tt> C:\Users\Foo&gt;gpg-connect-agent --hex
 &gt; scd apdu 00 20 00 81 08 40 40 40 40 40 40 40 40
 D[0000]  63 C2                                              c.
 OK
 &gt; scd apdu 00 20 00 81 08 40 40 40 40 40 40 40 40
 D[0000]  63 C1                                              c.
 OK
 &gt; scd apdu 00 20 00 81 08 40 40 40 40 40 40 40 40
 D[0000]  63 C0                                              c.
 OK
 &gt; scd apdu 00 20 00 81 08 40 40 40 40 40 40 40 40
 D[0000]  63 C0                                              c.
 OK
 &gt; scd apdu 00 20 00 83 08 40 40 40 40 40 40 40 40
 D[0000]  63 C2                                              c.
 OK
 &gt; scd apdu 00 20 00 83 08 40 40 40 40 40 40 40 40
 D[0000]  63 C1                                              c.
 OK
 &gt; scd apdu 00 20 00 83 08 40 40 40 40 40 40 40 40
 D[0000]  63 C0                                              c.
 OK
 scd apdu 00 20 00 83 08 40 40 40 40 40 40 40 40
 D[0000]  63 C0                                              c.
 OK</tt></pre>
</div></div>
<div class="paragraph"><p>Make sure the response goes down to C0, it is possible to have other
retry counters than the default of 3.  Then, the card is terminated
and reactivated as follows.</p></div>
<div class="literalblock">
<div class="content">
<pre><tt> &gt; scd apdu 00 e6 00 00
 D[0000]  90 00                                              ..
 OK
 &gt; scd apdu 00 44 00 00
 D[0000]  90 00                                              ..
 OK</tt></pre>
</div></div>
<div class="paragraph"><p>After this, close the connection, remove the card and reinsert it
again. The applet should be reset.</p></div>
<div class="paragraph"><p>To make things easier you may want to create a script. To do so, put
the following into a script file and run it using gpg-connect-agent
(gpg-connect-agent -r FILE).</p></div>
<div class="literalblock">
<div class="content">
<pre><tt> /hex
 scd serialno
 scd apdu 00 20 00 81 08 40 40 40 40 40 40 40 40
 scd apdu 00 20 00 81 08 40 40 40 40 40 40 40 40
 scd apdu 00 20 00 81 08 40 40 40 40 40 40 40 40
 scd apdu 00 20 00 81 08 40 40 40 40 40 40 40 40
 scd apdu 00 20 00 83 08 40 40 40 40 40 40 40 40
 scd apdu 00 20 00 83 08 40 40 40 40 40 40 40 40
 scd apdu 00 20 00 83 08 40 40 40 40 40 40 40 40
 scd apdu 00 20 00 83 08 40 40 40 40 40 40 40 40
 scd apdu 00 e6 00 00
 scd apdu 00 44 00 00
 /echo Card has been successfully reset.</tt></pre>
</div></div>
</div>
</div>

</section>
</div>

<!-- FOOTER  -->
<div id="footer_wrap" class="outer">
<footer class="inner">
<p class="copyright">ykneo-openpgp maintained by <a href="https://github.com/Yubico">Yubico</a></p>
<p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
</footer>
</div></body></html>
