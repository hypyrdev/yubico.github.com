<!DOCTYPE html>
<html>

  <head>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-6195355-4', 'yubico.com');
  ga('send', 'pageview');

</script>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="yubikey-ksm : YubiKey Key Storage Module" />

    <link rel="stylesheet" type="text/css" media="screen" href="/stylesheets/stylesheet.css">

    <title>yubikey-ksm</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
        <span class="breadcrumb">
          <a href="/">Software listing</a>
          /
          <a href="/yubikey-ksm/">yubikey-ksm</a>
          /
          <a>KeyProvisioningFormat</a>
          </span>
          <a id="forkme_banner" href="https://github.com/Yubico/yubikey-ksm">View on GitHub</a>
<a id="travis_link" href="https://travis-ci.org/Yubico/yubikey-ksm"><img id="travis_img" src="https://travis-ci.org/Yubico/yubikey-ksm.svg?branch=master"/></a>
          <h1><a id="project_title" href="/yubikey-ksm/">yubikey-ksm</a></h1>
          <h2 id="project_tagline">YubiKey Key Storage Module</h2>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
<div class="sect1">
<h2 id="_key_provisioning_data_format">Key Provisioning Data Format</h2>
<div class="sectionbody">
<div class="paragraph"><p>This file holds data used in the Yubikey personalization phase.</p></div>
<div class="paragraph"><p>The file is an OpenPGP signed and encrypted text file.  Readers should
support both CRLF and LF line endings.  The values are text and
separated by comma ("," ASCII 0x2C).  The first line of the file MUST
be as follows:</p></div>
<div class="literalblock">
<div class="content">
<pre><code># ykksm 1</code></pre>
</div></div>
<div class="paragraph"><p>Each of the rest lines in the file follows the following format:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>serialNr,publicName,internalName,aesKey,lockCode,created,accessed[,progflags] # comment</code></pre>
</div></div>
<div class="paragraph"><p>Any data after a # is treated as a comment and is ignored.  Lines of
the following format:</p></div>
<div class="literalblock">
<div class="content">
<pre><code># comment</code></pre>
</div></div>
<div class="paragraph"><p>are also treated as comments.</p></div>
<div class="paragraph"><p>The meaning are as follows:</p></div>
<div class="ulist"><ul>
<li>
<p>
serialNr:
</p>
<div class="literalblock">
<div class="content">
<pre><code>the serial number of the device used for the barcode, decimal integer</code></pre>
</div></div>
</li>
<li>
<p>
publicName:
</p>
<div class="literalblock">
<div class="content">
<pre><code>encoding of the "external" yubikey prefix, 0-16 modhex characters, typically 12
modhex encoded data</code></pre>
</div></div>
</li>
<li>
<p>
internalName:
</p>
<div class="literalblock">
<div class="content">
<pre><code>encoding of the "internal" yubikey identity, always 6 binary bytes = 12 hex,
hex encoded data</code></pre>
</div></div>
</li>
<li>
<p>
aesKey:
</p>
<div class="literalblock">
<div class="content">
<pre><code>an aes key used for the device, length decides whether it is a 128, 192, or 256 bit keys.
hex encoded data</code></pre>
</div></div>
</li>
<li>
<p>
lockCode:
</p>
<div class="literalblock">
<div class="content">
<pre><code>the locking code, always 6 binary bytes = 12 hex,
hex encoded data</code></pre>
</div></div>
</li>
<li>
<p>
created:
</p>
<div class="literalblock">
<div class="content">
<pre><code>timestamp of when the key was created
for example 2009-02-24T17:41:57 or empty</code></pre>
</div></div>
</li>
<li>
<p>
accessed:
</p>
<div class="literalblock">
<div class="content">
<pre><code>timestamp of when the key was last accessed
for example 2009-02-24T17:41:57 or empty</code></pre>
</div></div>
</li>
<li>
<p>
progflags:
</p>
<div class="literalblock">
<div class="content">
<pre><code>optional field, integer with flags used during personalization
to enable, e.g., static key mode or cr output</code></pre>
</div></div>
</li>
</ul></div>
<div class="paragraph"><p>Examples of valid data lines:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>4711,dlcfffckrcde,ca62baca62ba,ecde18dbe76fbd0c33330f1c354871db,be70aeca62ba,2009-01-22 00:25:11,
4712,,ca62baca62ba,ecde18dbe76fbd0c33330f1c354871db,be70aeca62ba,2009-01-22 00:25:11,2009-02-13 00:05:40
4713,dlcfffckrcdedlcf,ca62baca62ba,ecde18dbe76fbd0c33330f1c354871db,be70aeca62ba,2009-01-22 00:25:11,2009-02-13 00:05:40,0
4714,dlcfffckrcdedlcf,ca62baca62ba,ecde18dbe76fbd0c33330f1c354871db,be70aeca62ba,2009-01-22 00:25:11,2009-02-13 00:05:40,4711</code></pre>
</div></div>
<div class="paragraph"><p>Example of actual data using the password <em>foobar</em> (normally it would
be encrypted to a particular OpenPGP key id):</p></div>
<div class="literalblock">
<div class="content">
<pre><code> -----BEGIN PGP MESSAGE-----
 Version: GnuPG v1.4.9 (GNU/Linux)

 jA0EAwMClfljrWYVfm5gycDMIpZXLnzKtUfeEsqXRp63IdAghBzAfdIt4aeJ2kdV
 x8uvvHKeHfytjEo/U9Wg4NYqYoDnMeb4zXBmrRqWu558ldW75e5R2kPImuQnZIBQ
 3WKRbElrLpQTlbdyDDAzlOnVLvTrmekZ8ByUrED3tyZKJw7OW5YsHi3z5N+QNFbZ
 hpMWfDBiJRksQEXv3BbiWVojSS+ZlCBiDjqnbIGuk0nZlJSe3F3Jwdz22Y05aU2h
 +2e6vWkqsbvZMVHnU6pauyaM1dh2owXsoHCPLM1fs7ztIh5dAnV9d0TuW4ufKEFQ
 FdH5c4dNgl36CNM8dDlM3c8YpfjxlQ11e6ub7QZC1Eu3gqvfPIvYpczlwjkYOkcH
 nu1Iq42VgUSJzBr36aL9lLySyT8WRizzmJLaGYX/YqKgBXt6RTSO984WsxE6cl80
 paFvFOjybJ2V5GYc7pfdZAM2ySEhnS6PaxYAQXfrEhhtTTCCg1eCqKh4Yamv3u0v
 DAkppMqXeprjpC4cNvrQsVOKGx7HissA5x4rECLC
 =d54w
 -----END PGP MESSAGE-----</code></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_naming_scheme">Naming Scheme</h2>
<div class="sectionbody">
<div class="paragraph"><p>The files should use the standard GnuPG output extension <em>.asc</em>.</p></div>
<div class="paragraph"><p>If you want to store many keys in a one-key per file approach, we
suggest to create files named after the serial number.  For example:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>0.asc
1.asc
2.asc
3.asc
4.asc
5.asc
6.asc
7.asc
8.asc
9.asc
10.asc
11.asc
...</code></pre>
</div></div>
</div>
</div>

</section>
</div>

<!-- FOOTER  -->
<div id="footer_wrap" class="outer">
<footer class="inner">
<p class="copyright">yubikey-ksm maintained by <a href="https://github.com/Yubico">Yubico</a></p>
</footer>
</div></body></html>
